# WorkflowåŠŸèƒ½å®ç°å®ŒæˆæŠ¥å‘Š

**æ—¥æœŸ**: 2026-01-09
**çŠ¶æ€**: âœ… å…¨éƒ¨å®Œæˆ

---

## ğŸ“‹ å®æ–½å†…å®¹

### 1. WorkflowEngineç±»åˆ›å»º âœ…

**æ–‡ä»¶**: [leo-orchestrator/workflow_engine.py](leo-orchestrator/workflow_engine.py)

**åŠŸèƒ½**:
- å·¥ä½œæµæ‰§è¡Œå¼•æ“
- å¤šæ­¥éª¤Agentåä½œ
- æ•°æ®ä¼ é€’æœºåˆ¶
- é”™è¯¯å¤„ç†å’ŒçŠ¶æ€è·Ÿè¸ª

**æ ¸å¿ƒæ–¹æ³•**:
```python
class WorkflowEngine:
    def execute(self, workflow, **kwargs):
        """æ‰§è¡Œå·¥ä½œæµ"""
        # éå†æ­¥éª¤
        # è°ƒç”¨Agent
        # ä¼ é€’æ•°æ®
        # å¤„ç†é”™è¯¯
        # è¿”å›ç»“æœ
```

### 2. APIæ›´æ–° âœ…

**æ–‡ä»¶**: [leo-orchestrator/api.py](leo-orchestrator/api.py)

**æ›´æ–°å†…å®¹**:
- å®ç°äº†`run_workflow`æ–¹æ³•çš„å®é™…æ‰§è¡Œé€»è¾‘
- åŠ¨æ€åŠ è½½WorkflowEngine
- æ”¯æŒä¼ å…¥agentså‚æ•°

**ä½¿ç”¨æ–¹å¼**:
```python
result = api.run_workflow(
    "content-pipeline",
    agents=system.agents,
    topic="æˆ¿åœ°äº§å¸‚åœºåˆ†æ"
)
```

### 3. LeoSystemé›†æˆ âœ…

**æ–‡ä»¶**: [leo-system.py](leo-system.py)

**æ–°å¢æ–¹æ³•**:
```python
def run_workflow(self, workflow_name: str, **kwargs):
    """è¿è¡Œå·¥ä½œæµ"""
    return self.api.run_workflow(workflow_name, agents=self.agents, **kwargs)
```

### 4. æµ‹è¯•è„šæœ¬ âœ…

**æ–‡ä»¶**: [test_workflows.py](test_workflows.py)

**æµ‹è¯•å†…å®¹**:
- content-pipeline (å†…å®¹ç”Ÿäº§çº¿)
- research-pipeline (ç ”ç©¶çº¿)
- analysis-pipeline (åˆ†æçº¿)

---

## ğŸ§ª æµ‹è¯•ç»“æœ

### æµ‹è¯•æ‰§è¡Œ

```bash
python test_workflows.py
```

### æµ‹è¯•ç»“æœæ±‡æ€»

| Workflow | æ­¥éª¤æ•° | æˆåŠŸæ­¥éª¤ | å¤±è´¥æ­¥éª¤ | çŠ¶æ€ |
|----------|--------|----------|----------|------|
| content-pipeline | 3 | 3 | 0 | âœ… æˆåŠŸ |
| research-pipeline | 2 | 2 | 0 | âœ… æˆåŠŸ |
| analysis-pipeline | 2 | 2 | 0 | âœ… æˆåŠŸ |

**æ€»ä½“ç»“æœ**: ğŸ‰ æ‰€æœ‰å·¥ä½œæµæµ‹è¯•é€šè¿‡ï¼

### è¯¦ç»†æµ‹è¯•è¾“å‡º

#### æµ‹è¯•1: content-pipeline

```
ğŸ”„ å¼€å§‹æ‰§è¡Œå·¥ä½œæµ: å†…å®¹ç”Ÿäº§çº¿
   æè¿°: ç ”ç©¶â†’åˆ›ä½œâ†’å‘å¸ƒçš„å®Œæ•´æµç¨‹
   æ­¥éª¤æ•°: 3

ğŸ“ æ­¥éª¤ 1/3: research
   Agent: research-agent
   æè¿°: ä¿¡æ¯æ”¶é›†å’Œç ”ç©¶
   âœ… æ­¥éª¤å®Œæˆ

ğŸ“ æ­¥éª¤ 2/3: create
   Agent: creative-agent
   æè¿°: å†…å®¹åˆ›ä½œ
   âœ… æ­¥éª¤å®Œæˆ

ğŸ“ æ­¥éª¤ 3/3: publish
   Agent: task-agent
   æè¿°: å‘å¸ƒå’Œæ¨å¹¿
   âœ… æ­¥éª¤å®Œæˆ

============================================================
ğŸ“Š å·¥ä½œæµæ‰§è¡Œå®Œæˆ: å†…å®¹ç”Ÿäº§çº¿
============================================================
æ€»æ­¥éª¤æ•°: 3
æˆåŠŸ: 3
å¤±è´¥: 0
```

#### æµ‹è¯•2: research-pipeline

```
ğŸ”„ å¼€å§‹æ‰§è¡Œå·¥ä½œæµ: ç ”ç©¶çº¿
   æè¿°: æ”¶é›†â†’åˆ†æçš„çº¯ç ”ç©¶æµç¨‹
   æ­¥éª¤æ•°: 2

ğŸ“ æ­¥éª¤ 1/2: collect
   Agent: research-agent
   æè¿°: ä¿¡æ¯æ”¶é›†
   âœ… æ­¥éª¤å®Œæˆ

ğŸ“ æ­¥éª¤ 2/2: analyze
   Agent: analysis-agent
   æè¿°: æ•°æ®åˆ†æ
   âœ… æ­¥éª¤å®Œæˆ

============================================================
ğŸ“Š å·¥ä½œæµæ‰§è¡Œå®Œæˆ: ç ”ç©¶çº¿
============================================================
æ€»æ­¥éª¤æ•°: 2
æˆåŠŸ: 2
å¤±è´¥: 0
```

#### æµ‹è¯•3: analysis-pipeline

```
ğŸ”„ å¼€å§‹æ‰§è¡Œå·¥ä½œæµ: åˆ†æçº¿
   æè¿°: åˆ†æâ†’æŠ¥å‘Šçš„çº¯åˆ†ææµç¨‹
   æ­¥éª¤æ•°: 2

ğŸ“ æ­¥éª¤ 1/2: analyze
   Agent: analysis-agent
   æè¿°: æ‰§è¡Œåˆ†æ
   âœ… æ­¥éª¤å®Œæˆ

ğŸ“ æ­¥éª¤ 2/2: report
   Agent: task-agent
   æè¿°: ç”ŸæˆæŠ¥å‘Š
   âœ… æ­¥éª¤å®Œæˆ

============================================================
ğŸ“Š å·¥ä½œæµæ‰§è¡Œå®Œæˆ: åˆ†æçº¿
============================================================
æ€»æ­¥éª¤æ•°: 2
æˆåŠŸ: 2
å¤±è´¥: 0
```

---

## ğŸ¯ å®ç°çš„åŠŸèƒ½

### 1. å·¥ä½œæµæ‰§è¡Œ

âœ… **å¤šæ­¥éª¤ç¼–æ’**: æ”¯æŒæŒ‰é¡ºåºæ‰§è¡Œå¤šä¸ªAgent
âœ… **æ•°æ®ä¼ é€’**: æ­¥éª¤é—´è‡ªåŠ¨ä¼ é€’æ‰§è¡Œç»“æœ
âœ… **é”™è¯¯å¤„ç†**: æ•è·å¼‚å¸¸å¹¶è®°å½•é”™è¯¯ä¿¡æ¯
âœ… **çŠ¶æ€è·Ÿè¸ª**: å®æ—¶æ˜¾ç¤ºæ‰§è¡Œè¿›åº¦å’ŒçŠ¶æ€

### 2. Agentåä½œ

âœ… **è‡ªåŠ¨è°ƒç”¨**: æ ¹æ®é…ç½®è‡ªåŠ¨è°ƒç”¨æŒ‡å®šAgent
âœ… **ä¸Šä¸‹æ–‡å…±äº«**: æ‰€æœ‰æ­¥éª¤å…±äº«æ‰§è¡Œä¸Šä¸‹æ–‡
âœ… **ç»“æœèšåˆ**: æ”¶é›†æ‰€æœ‰æ­¥éª¤çš„æ‰§è¡Œç»“æœ

### 3. æ‰§è¡Œæ§åˆ¶

âœ… **æˆåŠŸ/å¤±è´¥ç»Ÿè®¡**: ç»Ÿè®¡æˆåŠŸå’Œå¤±è´¥çš„æ­¥éª¤æ•°
âœ… **ä¸­æ–­æœºåˆ¶**: æ­¥éª¤å¤±è´¥æ—¶å¯é€‰æ‹©ä¸­æ–­æˆ–ç»§ç»­
âœ… **æ‰§è¡Œå†å²**: è®°å½•æ‰€æœ‰å·¥ä½œæµçš„æ‰§è¡Œå†å²

---

## ğŸ’» ä½¿ç”¨ç¤ºä¾‹

### ç¤ºä¾‹1: è¿è¡Œå†…å®¹ç”Ÿäº§çº¿

```python
from leo_system import LeoSystem

system = LeoSystem()

# è¿è¡Œå†…å®¹ç”Ÿäº§çº¿
result = system.run_workflow(
    "content-pipeline",
    task="ç”Ÿæˆ2026å¹´å®æ³¢æˆ¿åœ°äº§å¸‚åœºè¶‹åŠ¿åˆ†ææ–‡ç« ",
    topic="å®æ³¢æˆ¿åœ°äº§å¸‚åœº",
    year=2026
)

# æ£€æŸ¥ç»“æœ
if result['success']:
    print(f"âœ… å·¥ä½œæµæ‰§è¡ŒæˆåŠŸ")
    print(f"   æˆåŠŸæ­¥éª¤: {result['successful_steps']}/{result['total_steps']}")
```

### ç¤ºä¾‹2: è¿è¡Œç ”ç©¶çº¿

```python
# è¿è¡Œç ”ç©¶çº¿
result = system.run_workflow(
    "research-pipeline",
    task="è°ƒç ”æ™ºæ…§å†œè´¸å¸‚åœºç«å“åˆ†æ",
    topic="æ™ºæ…§å†œè´¸å¸‚åœº",
    focus="ç«å“åˆ†æ"
)
```

### ç¤ºä¾‹3: è¿è¡Œåˆ†æçº¿

```python
# è¿è¡Œåˆ†æçº¿
result = system.run_workflow(
    "analysis-pipeline",
    task="åˆ†ææœˆåº¦é”€å”®æ•°æ®",
    data=[100, 120, 110, 130, 150, 140],
    title="2026å¹´1æœˆé”€å”®åˆ†ææŠ¥å‘Š"
)
```

---

## ğŸ”§ æŠ€æœ¯ç»†èŠ‚

### å·¥ä½œæµæ‰§è¡Œæµç¨‹

```
1. åŠ è½½å·¥ä½œæµé…ç½®
   â†“
2. åˆå§‹åŒ–ä¸Šä¸‹æ–‡ï¼ˆkwargsï¼‰
   â†“
3. éå†æ­¥éª¤
   â”œâ”€ è·å–Agent
   â”œâ”€ æ‰§è¡ŒAgent.execute()
   â”œâ”€ æ”¶é›†ç»“æœ
   â””â”€ æ›´æ–°ä¸Šä¸‹æ–‡
   â†“
4. ç”Ÿæˆæœ€ç»ˆç»“æœ
   â†“
5. è®°å½•æ‰§è¡Œå†å²
```

### æ•°æ®ä¼ é€’æœºåˆ¶

```python
# åˆå§‹ä¸Šä¸‹æ–‡
context = {
    'task': 'ç”Ÿæˆæ–‡ç« ',
    'topic': 'æˆ¿åœ°äº§å¸‚åœº'
}

# Step 1: Research Agent
result1 = research_agent.execute('research', **context)
# result1 = {'data': [...], 'sources': [...]}

# æ›´æ–°ä¸Šä¸‹æ–‡
context.update(result1)
# context = {'task': ..., 'topic': ..., 'data': [...], 'sources': [...]}

# Step 2: Creative Agent (æ¥æ”¶Step 1çš„ç»“æœ)
result2 = creative_agent.execute('create', **context)
```

### é”™è¯¯å¤„ç†

```python
try:
    result = agent.execute(task, **context)
    results.append({
        'step': step_name,
        'success': True,
        'result': result
    })
except Exception as e:
    results.append({
        'step': step_name,
        'success': False,
        'error': str(e)
    })

    # å†³å®šæ˜¯å¦ç»§ç»­
    if not workflow.get('continue_on_error', False):
        break  # ä¸­æ–­æ‰§è¡Œ
```

---

## ğŸ“Š ç³»ç»ŸçŠ¶æ€

### å®Œæ•´åŠŸèƒ½æ¸…å•

| ç»„ä»¶ | æ•°é‡ | çŠ¶æ€ |
|------|------|------|
| Skills | 8 | âœ… å…¨éƒ¨å¯ç”¨ |
| Agents | 5 | âœ… å…¨éƒ¨å¯ç”¨ |
| Workflows | 3 | âœ… å…¨éƒ¨å¯ç”¨ |

### åŠŸèƒ½å®Œæ•´æ€§

- âœ… Skillså±‚ - 100%å®Œæˆ
- âœ… Agentså±‚ - 100%å®Œæˆ
- âœ… Workflowså±‚ - 100%å®Œæˆ

---

## ğŸ‰ æ€»ç»“

### å®Œæˆçš„å·¥ä½œ

1. âœ… åˆ›å»ºWorkflowEngineç±»
2. âœ… å®ç°Workflowæ‰§è¡Œé€»è¾‘
3. âœ… æ›´æ–°api.pyçš„run_workflowæ–¹æ³•
4. âœ… åœ¨leo-system.pyä¸­æ·»åŠ run_workflowæ–¹æ³•
5. âœ… æµ‹è¯•3ä¸ªworkflows - å…¨éƒ¨é€šè¿‡

### ç³»ç»Ÿèƒ½åŠ›

**ä¹‹å‰**:
- Workflowså·²é…ç½®ä½†æ— æ³•æ‰§è¡Œ
- åªèƒ½å•ç‹¬è°ƒç”¨Agentæˆ–Skill

**ç°åœ¨**:
- âœ… Workflowså®Œå…¨å¯ç”¨
- âœ… æ”¯æŒå¤šAgentåä½œ
- âœ… è‡ªåŠ¨æ•°æ®ä¼ é€’
- âœ… å®Œæ•´çš„é”™è¯¯å¤„ç†

### åº”ç”¨ä»·å€¼

1. **å†…å®¹ç”Ÿäº§è‡ªåŠ¨åŒ–**: content-pipelineå¯ä»¥è‡ªåŠ¨å®Œæˆç ”ç©¶â†’åˆ›ä½œâ†’å‘å¸ƒçš„å®Œæ•´æµç¨‹
2. **ç ”ç©¶åˆ†ææµç¨‹åŒ–**: research-pipelineå¯ä»¥ç³»ç»ŸåŒ–åœ°å®Œæˆä¿¡æ¯æ”¶é›†å’Œåˆ†æ
3. **æ•°æ®åˆ†ææ ‡å‡†åŒ–**: analysis-pipelineæä¾›æ ‡å‡†çš„æ•°æ®åˆ†æå’ŒæŠ¥å‘Šç”Ÿæˆæµç¨‹

---

## ğŸ“ ä½¿ç”¨å»ºè®®

### 1. é€‰æ‹©åˆé€‚çš„Workflow

- **å†…å®¹åˆ›ä½œ**: ä½¿ç”¨content-pipeline
- **å¸‚åœºè°ƒç ”**: ä½¿ç”¨research-pipeline
- **æ•°æ®åˆ†æ**: ä½¿ç”¨analysis-pipeline

### 2. ä¼ é€’æ­£ç¡®çš„å‚æ•°

```python
# å¿…éœ€å‚æ•°
task: str  # ä»»åŠ¡æè¿°

# å¯é€‰å‚æ•°ï¼ˆæ ¹æ®workflowéœ€æ±‚ï¼‰
topic: str  # ä¸»é¢˜
data: list  # æ•°æ®
year: int   # å¹´ä»½
focus: str  # å…³æ³¨ç‚¹
```

### 3. æ£€æŸ¥æ‰§è¡Œç»“æœ

```python
result = system.run_workflow(...)

# æ£€æŸ¥æˆåŠŸçŠ¶æ€
if result['success']:
    print("âœ… æˆåŠŸ")
else:
    print(f"âŒ å¤±è´¥: {result['failed_steps']} ä¸ªæ­¥éª¤å¤±è´¥")

# æŸ¥çœ‹è¯¦ç»†ç»“æœ
for step_result in result['results']:
    print(f"{step_result['step']}: {step_result['success']}")
```

---

**å®Œæˆæ—¶é—´**: 2026-01-09
**ç»´æŠ¤è€…**: Leo Liu
**ç‰ˆæœ¬**: 1.0.0
**çŠ¶æ€**: âœ… å…¨éƒ¨åŠŸèƒ½å·²å®ç°å¹¶æµ‹è¯•é€šè¿‡
