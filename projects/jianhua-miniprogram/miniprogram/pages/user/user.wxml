<!--pages/user/user.wxml-->
<view class="container">
  <!-- ç”¨æˆ·ä¿¡æ¯ -->
  <view class="user-header">
    <image class="avatar" src="{{userInfo.avatar || '/images/default-avatar.png'}}" mode="aspectFill"/>
    <view class="user-info">
      <text class="nickname">{{userInfo.nickname || 'æœªç™»å½•'}}</text>
      <text class="phone">{{userInfo.phone || 'ç‚¹å‡»ç™»å½•'}}</text>
    </view>
    <view class="invite-code" wx:if="{{isLogin}}">
      <text class="code-label">é‚€è¯·ç </text>
      <text class="code-value">{{userInfo.invite_code}}</text>
    </view>
  </view>

  <!-- æ•°æ®ç»Ÿè®¡ -->
  <view class="stats-card card" wx:if="{{isLogin}}">
    <view class="stats-item">
      <text class="stats-value">{{stats.inviteCount}}</text>
      <text class="stats-label">é‚€è¯·å¥½å‹</text>
    </view>
    <view class="stats-item">
      <text class="stats-value">{{stats.giftCount}}</text>
      <text class="stats-label">è·å¾—ç¤¼å“</text>
    </view>
    <view class="stats-item">
      <text class="stats-value">{{stats.visitCount}}</text>
      <text class="stats-label">åˆ°è®¿æ¬¡æ•°</text>
    </view>
  </view>

  <!-- æˆ‘çš„ç¤¼å“ -->
  <view class="card" wx:if="{{isLogin}}">
    <view class="card-header">
      <text class="card-title">æˆ‘çš„ç¤¼å“</text>
      <text class="card-more" bindtap="viewAllGifts">æŸ¥çœ‹å…¨éƒ¨</text>
    </view>
    <view class="gift-list" wx:if="{{gifts.length > 0}}">
      <view class="gift-item" wx:for="{{gifts}}" wx:key="id">
        <view class="gift-info">
          <text class="gift-name">{{item.name}}</text>
          <text class="gift-status {{item.status}}">{{item.statusText}}</text>
        </view>
        <text class="gift-expire">{{item.expire}}</text>
      </view>
    </view>
    <view class="empty-tip" wx:else>æš‚æ— ç¤¼å“</view>
  </view>

  <!-- åŠŸèƒ½èœå• -->
  <view class="menu-list card">
    <view class="menu-item" bindtap="goToAppointment" wx:if="{{isLogin}}">
      <text class="menu-icon">ğŸ“…</text>
      <text class="menu-text">æˆ‘çš„é¢„çº¦</text>
      <text class="menu-arrow">â€º</text>
    </view>
    <view class="menu-item" bindtap="goToShare" wx:if="{{isLogin}}">
      <text class="menu-icon">ğŸ‘¥</text>
      <text class="menu-text">é‚€è¯·è®°å½•</text>
      <text class="menu-arrow">â€º</text>
    </view>
    <view class="menu-item" bindtap="makePhoneCall">
      <text class="menu-icon">ğŸ“</text>
      <text class="menu-text">è”ç³»å®¢æœ</text>
      <text class="menu-arrow">â€º</text>
    </view>
    <view class="menu-item" bindtap="showAbout">
      <text class="menu-icon">â„¹ï¸</text>
      <text class="menu-text">å…³äºæˆ‘ä»¬</text>
      <text class="menu-arrow">â€º</text>
    </view>
  </view>

  <!-- ç™»å½•æŒ‰é’® -->
  <view class="btn-area" wx:if="{{!isLogin}}">
    <button class="btn-login" open-type="getPhoneNumber" bindgetphonenumber="onGetPhone">
      ä¸€é”®æ‰‹æœºç™»å½•
    </button>
  </view>

  <!-- é€€å‡ºç™»å½• -->
  <view class="btn-area" wx:if="{{isLogin}}">
    <button class="btn-logout" bindtap="logout">é€€å‡ºç™»å½•</button>
  </view>
</view>
